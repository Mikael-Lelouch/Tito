'@type': "SoftwareComponentType"
createdDate: "2016-11-19T13:03:11.930Z"
lastUpdated: "2016-11-19T19:12:30.273Z"
id: "Software.TitoFE"
name: "Tito-FE"
description: "Created by Vince on the 19 of Nov 2016\nContains all necessary step\
  \ to properly install the Tito Front end"
publishStatus: "PUBLISHED"
publishStatusName: "Published"
schema:
  fields:
  - id: "host"
    label: "Container"
    description: ""
    dataType:
      type: "ref"
      componentTypeId: "com.vmware.csp.iaas.blueprint.service"
      classId: "Infrastructure.Machine.Schema"
      label: "Machine"
    state:
      dependencies: []
      facets:
      - type: "internal"
        value:
          type: "constantClause"
          value:
            type: "boolean"
            value: true
      - type: "visible"
        value:
          type: "constantClause"
          value:
            type: "boolean"
            value: false
      - type: "mandatory"
        value:
          type: "constant"
          value:
            type: "boolean"
            value: true
    isMultiValued: false
  - id: "SQLSERVER"
    label: "SQLSERVER"
    description: "IP/FQDN dur serveur MySQL"
    dataType:
      type: "primitive"
      typeId: "STRING"
    state:
      dependencies: []
      facets:
      - type: "defaultValue"
        value:
          type: "constant"
          value:
            type: "string"
            value: ""
      - type: "mandatory"
        value:
          type: "constant"
          value:
            type: "boolean"
            value: true
    isMultiValued: false
containerFieldId: "host"
lifecycleTasks:
- createdDate: "2016-11-19T13:03:11.931Z"
  lastUpdated: "2016-11-20T21:32:35.515Z"
  script:
    scriptContent: "#!/bin/bash\n#This script install all the packages needed for\
      \ the Tito Front End (Apache, git)\n#It also configure the necessary files\n\
      #it download the necessary sources from  Git\n#and it start the service\n\n\
      #variables#######################\nHTMLPATH=/var/www/html\nGITREPO=https://github.com/vmeoc/Tito/\n\
      HTTPDCONF=/etc/httpd/conf/httpd.conf\n#################################\necho\
      \ \necho -e \"Open Firewall port 80\\n\"\n\nfirewall-cmd --zone=public --add-port=80/tcp\
      \ --permanent\nfirewall-cmd --reload\n\n\necho\necho -e \"Install Apache & PHP\\\
      n\"\n\nyum update -y\nyum install httpd -y\nservice httpd start\nyum install\
      \ php -y\nyum install php-mysql -y\n/usr/sbin/chkconfig httpd on\n\necho\necho\
      \ -e \"deactive selinux to reach remote db\"\necho \"SELINUXTYPE=disabled\"\
      \ > /etc/sysconfig/selinux\n\necho\necho -e \"install Git\\n\"\n\nyum install\
      \ git -y\n\necho\necho -e \"Install Tito sources \\n\"\n\n\ncd $HTMLPATH\ngit\
      \ clone $GITREPO .\ngit checkout tags/V1.5\n\necho\necho -e \"conf httpd.conf\
      \ pour prise en compte de PHP et paramÃ¨trage du serveur SQL\\n\"\n\n\necho \"\
      LoadModule php5_module modules/libphp5.so\" >> $HTTPDCONF\ncat <<EOF >> $HTTPDCONF\n\
      <IfModule env_module>\n    SetEnv TITO-SQL \"$SQLSERVER\"\n</IfModule>\nEOF\n\
      \necho -e \"conf php.ini pour Timezone \\n\"\n\necho \"date.timezone = \\\"\
      Europe/Paris\\\"\" >> /etc/php.ini\n\n\n#reboot to be done at the end by vRA"
    isRebootAfter: true
    scriptTypeId: "Bash"
  taskDescriptorRef:
    id: "INSTALL"
    label: "Install"
